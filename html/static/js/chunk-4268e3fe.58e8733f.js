(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4268e3fe"],{1971:function(t,e,n){"use strict";var i=n("ee52"),a=n.n(i);a.a},"3d41":function(t,e,n){"use strict";var i=n("ba57"),a=n.n(i);a.a},"57e7":function(t,e,n){"use strict";var i=n("5ca1"),a=n("c366")(!1),s=[].indexOf,o=!!s&&1/[1].indexOf(1,-0)<0;i(i.P+i.F*(o||!n("2f21")(s)),"Array",{indexOf:function(t){return o?s.apply(this,arguments)||0:a(this,t,arguments[1])}})},ba57:function(t,e,n){},d1d5:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cont"},[""!=t.map?n("GetRouter",{ref:"grouter",attrs:{map:t.map,center:t.center,destination:t.destination},on:{showRouter:function(e){t.userStatus=1},setSteps:t.setSteps,setPaths:t.setPaths,router_msg:t.getRouterMsg}}):t._e(),0!=t.userStatus?n("div",{class:["control",t.downc?"down-cont":""]},[n("div",{staticClass:"msg"},[n("h2",[t._v("我的位置 —— 微山湖停车场")]),n("p",[n("span",[t._v("距离"+t._s(t.$store.state.distance)+"米")]),n("span",[t._v("预计"+t._s(t.$store.state.distime)+"分钟")])])]),n("div",{staticClass:"cdiv"},[n("div",{staticClass:"shang"},[""!=t.map&&t.paths.length>0?n("Simulation",{attrs:{map:t.map,steps:t.steps,paths:t.paths},on:{start:function(e){t.downc=!0},end:function(e){t.downc=!1}}}):t._e(),n("StartNav",{attrs:{steps:t.steps,center:t.center,paths:t.paths},on:{start:t.starting,xunche:t.xunche,stop:t.stoping}})],1),n("div",{staticClass:"xia"},[n("Baidu",{attrs:{dest:t.destination}}),n("Gaode",{attrs:{dest:t.destination}}),n("Tencent",{attrs:{dest:t.destination}})],1)])]):t._e(),""!=t.map?n("locating",{attrs:{map:t.map},on:{changeCenter:t.changeCenter,achieveDistance:t.achieveDistance,achieveTime:t.achieveTime}}):t._e(),n("div",{staticClass:"amap-wrapper",attrs:{id:"container"}}),""!=t.map?n("ThreeDMap",{attrs:{map:t.map},on:{showRouterOne:t.showRouterOne}}):t._e()],1)},a=[],s=(n("28a5"),n("6d67"),n("6b54"),n("87b3"),n("67cc")),o=n("f015"),r=n("5ff3"),c=n("7e3c"),h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},p=[],u={props:["map"],data:function(){return{nowTime:(new Date).getTime(),oldTime:(new Date).getTime(),moveLength:0,center:"",oldP:"",newP:""}},methods:{locatedSucc:function(t){this.$emit("changeCenter",t.position),this.newP=t.position,""==this.center&&(this.oldP=t.position),this.center=t.position;var e=AMap.GeometryUtil.distance(this.oldP,this.newP);this.nowTime=(new Date).getTime(),e>200?(this.oldP=this.newP,this.oldTime=this.nowTime,this.$emit("achieveDistance")):this.nowTime-this.oldTime>25e3&&(this.oldTime=this.nowTime,this.$emit("achieveTime"))},locatedFail:function(t){console.log(t)},locating:function(){var t=this;this.geo.getCurrentPosition(function(e,n){"complete"==e?t.locatedSucc(n):t.locatedFail(n),t.ltimer=setTimeout(function(){t.locating()},2e3)})},init:function(){var t=this;this.map.plugin("AMap.Geolocation",function(){t.geolocation=new AMap.Geolocation({enableHighAccuracy:!0,timeout:3e3,maximumAge:0,convert:!0,showButton:!0,buttonPosition:"LB",buttonOffset:new AMap.Pixel(10,150),showMarker:!1,showCircle:!1,panToLocation:!0,zoomToAccuracy:!0}),t.geo=new AMap.Geolocation({enableHighAccuracy:!0,timeout:2e3,maximumAge:0,convert:!0,showButton:!1,showMarker:!0,showCircle:!1,panToLocation:!1,zoomToAccuracy:!1}),t.map.addControl(t.geolocation),t.map.addControl(t.geo),t.locating()})}},mounted:function(){this.init()}},l=u,m=n("2877"),d=Object(m["a"])(l,h,p,!1,null,null,null),f=d.exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"monidaohang",on:{click:t.startAni}},[t._v("\n\t模拟导航\n\t"),n("div",{directives:[{name:"show",rawName:"v-show",value:0!=t.moniStatus,expression:"moniStatus!=0"}],staticClass:"moni"},[n("div",{on:{click:function(e){return e.stopPropagation(),t.overAni(e)}}},[t._v("结束")]),n("div",{on:{click:function(e){return e.stopPropagation(),t.pauseAnimation(e)}}},[t._v("暂停")]),n("div",{on:{click:function(e){return e.stopPropagation(),t.resumeAnimation(e)}}},[t._v("继续")])])])},v=[],w=(n("57e7"),{props:["map","paths"],data:function(){return{currMaker:"",passedPolyline:"",passedPath:"",moniStatus:0,passLen:0,steps:this.$store.state.steps,stepAllPath:this.$store.state.stepAllPath}},methods:{hidePanel:function(){var t=this.paths[0].lng,e=this.paths[0].lat;this.currMaker.setPosition([t,e]),console.log(this.paths[0]),this.currMaker.hide(),this.passedPolyline.setPath(null),this.passedPolyline.hide()},startAni:function(){this.$emit("start"),this.currMaker.show(),this.passedPolyline.show(),console.log(this.paths),this.moniStatus=1,this.currMaker.moveAlong(this.paths,2e3)},overAni:function(){this.$emit("end"),this.moniStatus=0,this.currMaker.stopMove(),this.hidePanel()},pauseAnimation:function(){this.moniStatus=2,this.currMaker.pauseMove()},resumeAnimation:function(){this.moniStatus=1,this.currMaker.resumeMove()},init:function(){var t=this;t.currMaker=new AMap.Marker({map:t.map,position:t.paths[0],icon:"https://webapi.amap.com/images/car.png",offset:new AMap.Pixel(-26,-13),autoRotation:!0,angle:-90}),console.log("aa"),t.passedPolyline=new AMap.Polyline({map:t.map,strokeColor:"#AF5",strokeWeight:6,zIndex:900}),t.currMaker.on("moving",function(e){var n=e.passedPath.length;if(t.passLen!=n){var i=t.stepAllPath.indexOf(n);if(-1!=i){var a=t.steps[i].instruction;t.$toast({message:a,position:"top"})}t.passLen=n,t.map.setCenter(e.passedPath[n-1]),t.map.setZoom(15)}t.passedPolyline.setPath(e.passedPath),t.passedPath=e.passedPath}),t.map.setFitView(),t.currMaker.hide(),console.log("事件已预备")}},mounted:function(){this.init()}}),M=w,A=(n("3d41"),Object(m["a"])(M,g,v,!1,null,"37745633",null)),P=A.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},y=[],T=n("75fc"),b=(n("ac6a"),n("f3e2"),n("2caf"),n("386d"),{props:["map","center","destination"],data:function(){return{driving:"",paths:[],destMaker:"",steps:[],showRouter:!1,name:"",router_msg:{},stepHavePath:[]}},methods:{ifInPark:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=[117.277017,34.686287],e=[117.275433,34.684924],n=[117.276741,34.683621],i=[117.278132,34.684943];AMap.GeometryUtil.isPointInRing(this.center,[t,e,n,i]);console.log(ifInPark)}),searchRouter:function(t){this.$emit("showRouter"),this.showRouter=!0;var e=this,n=e.center,i=e.destination;""!=e.driving&&this.driving.setAvoidPolygons([[],[]]),e.driving.search(n,i,function(n,i){if(console.log(i),Array.isArray(i.routes)){e.$store.commit("getRouter_msg",i.routes[0]),e.router_msg=i.routes[0],e.$emit("router_msg",{msg:i.routes[0],type:t});var a=i.routes[0].steps;e.paths=[],e.stepHavePath=[],Array.isArray(a)&&(e.steps=a,a.length,a.forEach(function(t){var n;t.path instanceof Array&&(e.stepHavePath.push(t.path.length),(n=e.paths).push.apply(n,Object(T["a"])(t.path)))}),e.$store.commit("stepHavePath",e.stepHavePath),e.$emit("setSteps",a),e.$emit("setPaths",e.paths),console.log(e.paths)),1!=t?(e.map.setCenter(e.center),e.map.setZoom(19)):e.map.setRotation(0)}})},getRouter:function(t){var e=this;AMap.plugin("AMap.Driving",function(){e.driving=new AMap.Driving({map:e.map,policy:AMap.DrivingPolicy.LEAST_TIME,autoFitView:!1,hideMarkers:!0})})}},mounted:function(){this.getRouter()}}),_=b,$=Object(m["a"])(_,k,y,!1,null,null,null),R=$.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},x=[],D={props:["map"],data:function(){return{exitPoint:[[117.27645,34.685429],[117.277228,34.686052]],parkPoint:[[117.275838,34.684945],[117.27587,34.684966],[117.2759,34.684984],[117.275929,34.685009],[117.275955,34.685033],[117.275974,34.68506],[117.276018,34.685097],[117.276043,34.68512],[117.276073,34.685142],[117.2761,34.685167],[117.276122,34.68519],[117.276143,34.685215]]}},methods:{createMarker:function(){var t=this.parkPoint,e=[],n=new AMap.LabelsLayer({zIndex:1e3,collision:!0,animation:!0});this.map.add(n);for(var i=0;i<t.length;i++){var a=t[i],s=new AMap.LabelMarker({position:new AMap.LngLat(a[0],a[1]),opacity:1,zIndex:10,text:{content:""+(i+1),direction:"left",offset:[0,-5],zooms:[19,25],style:{fontSize:12,fontWeight:"normal",fillColor:"#fff",strokeColor:"#fff",strokeWidth:2}},extData:{id:i+1}});e.push(s),n.add(s)}var o=new AMap.OverlayGroup(e);this.map.add(o)},init:function(){var t=this,e=this,n=new AMap.Object3DLayer({zooms:[5,30],zIndex:100});this.map.add(n),this.map.plugin(["AMap.GltfLoader"],function(){var t=new AMap.GltfLoader,e="https://www.business-chain.cn/Apps/model/Parkingyard/wsholdAll01/gltfV5/wsholdAll01v5.gltf",i={position:new AMap.LngLat(117.27709,34.68649),scale:8420,height:0,scene:0};t.load(e,function(t){t,t.setOption(i),t.rotateX(180),t.rotateZ(0),n.add(t)})}),window.showRouter=function(){e.$emit("showRouterOne"),document.getElementsByClassName("mark2")[0].style.display="none"};var i='<div class="mark1"><img src="https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png" /><div>微山湖度假区一号停车场<p onclick="showRouter()" class="mark2">去这里</p></div></div>';this.destMaker=new AMap.Marker({position:[117.276839,34.68501],anchor:"center",content:i}),this.createMarker();var a=this.exitPoint;a.forEach(function(e,n){var i='<div class="mark3"><img src="//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-'.concat(n+1,'.png" /><div>').concat(n+1,"号出入口</div></div>"),a=new AMap.Marker({position:e,anchor:"center",content:i});t.map.add(a)}),this.map.add(this.destMaker)}},mounted:function(){this.init()}},C=D,L=Object(m["a"])(C,S,x,!1,null,null,null),O=L.exports,E={components:{Gaode:s["a"],Baidu:o["a"],StartNav:c["a"],Tencent:r["a"],Locating:f,Simulation:P,GetRouter:R,ThreeDMap:O},data:function(){return{downc:!1,inDaohang:!1,msg:"vue-amap向你问好！",userStatus:0,map:"",paths:[],center:null,centerp:null,geolocation:"",geo:"",oldTime:(new Date).getTime(),nowTime:(new Date).getTime(),destination:[117.276839,34.68501],ltimer:null,steps:null,passedPolyline:"",passedPath:"",currMaker:"",currLine:"",moveLine:"",moniStatus:0,destMaker:""}},methods:{getRouterMsg:function(t){t.type},showRouterOne:function(){this.$refs.grouter.searchRouter(1)},changeCenter:function(t){this.center=t},achieveDistance:function(){this.$toast("achieveDistance"),console.log("achieveDistance"),1==this.inDaohang&&this.$refs.grouter.searchRouter()},achieveTime:function(){this.$toast("achieveTime"),console.log("achieveTime"),1==this.inDaohang&&this.$refs.grouter.searchRouter()},setPaths:function(t){this.paths=t},setSteps:function(t){this.steps=t},xunche:function(){this.destination=[117.277289,34.684667],this.getRouter()},starting:function(){this.$refs.grouter.searchRouter(),this.inDaohang=!0,this.downc=!0},stoping:function(){this.inDaohang=!1,this.downc=!1},startAni:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){startAni()}),showRouter:function(){this.userStatus=1},init:function(){var t=this;this.map=new AMap.Map("container",{viewMode:"3D",expandZoomRange:!0,showBuildingBlock:!0,zoom:18,zooms:[3,22],pitch:45,rotation:228,center:t.destination,resizeEnable:!0,showLabel:!0,showIndoorMap:!0}),this.$store.commit("initMap",this.map)}},mounted:function(){console.log(this.$store.state.count);var t=this;i&&2==i.split(",").length&&(this.destination=i.split(","),console.log(this.destination)),window.inits=function(){t.init(),console.log(AMap)};var e="https://webapi.amap.com/maps?v=1.4.15&key=5a91b43f3d03c658319b29ab153e1af4&plugin=AMap.moveAnimation,Map3D,ElasticMarker&callback=inits",n=document.createElement("script");n.charset="utf-8",n.src=e,document.head.appendChild(n);var i=getQueryVariable("position")}},z=E,G=(n("1971"),Object(m["a"])(z,i,a,!1,null,"37eba13c",null));e["default"]=G.exports},ee52:function(t,e,n){}}]);